// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "linux-musl-openssl-3.0.x"]
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Comprador {
  id        String   @id @default(uuid()) @db.Char(36)
  nome      String   @db.VarChar(100)
  email     String   @unique @db.VarChar(100)
  senha     String   @db.VarChar(100)
  //tipocomprador    String   @db.Char(36)
  saldo          Decimal  @db.Decimal(9, 2)
  compras   Compra[]
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @updatedAt @map("updated_at")

  @@map("compradores")
}

model Organizador {
  id    String @id @default(uuid()) @db.Char(36)
  nome  String @db.VarChar(100)
  email String @unique @db.VarChar(100)
  senha String @db.VarChar(100)
  conta String @db.VarChar(30)
  cnpj  String @db.Char(18)

  eventos Evento[]

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @updatedAt @map("updated_at")

  @@map("organizadores")
}

model Evento {
  id                Int     @id @default(autoincrement()) @db.Int()
  titulo            String  @db.VarChar(100)
  descricao         String  @db.Text()
  localizacao       String  @db.VarChar(100)
  faixaEtaria       Int     @db.Int
  vagas             Int     @db.Int
  // imageUrl          String   @db.VarChar(100)
  organizadorId     String  @db.Char(36)
  categoriaEventoId Int     @db.Int()

  ticket     Ticket[]
  compras    Compra[]
  tiposTicketsEventos TiposTicketsEventos[]

  Organizador     Organizador     @relation(fields: [organizadorId], references: [id])
  CategoriaEvento CategoriaEvento @relation(fields: [categoriaEventoId], references: [id])

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @default(now()) @updatedAt @map("updated_at")

  @@map("eventos")
}

model Ticket {
  id           String   @id @default(uuid()) @db.Char(36)
  eventoId     Int      @db.Int()
  tipoTicketId Int   @db.Int()

  tipoTicket TipoTicket @relation(fields: [tipoTicketId], references: [id])
  evento     Evento     @relation(fields: [eventoId], references: [id])
  compra     Compra[]

  createdAt DateTime    @default(now()) @map("created_at")
  updatedAt DateTime    @default(now()) @updatedAt @map("updated_at")

  @@map("tickets")
}

model Compra {
  id             String  @id @default(uuid()) @db.Char(36)
  formaPagamento String  @db.VarChar(50)
  valor          Decimal  @db.Decimal(9, 2)
  status         String  @db.VarChar(50)

  compradorId String     @db.Char(36)
  ticketId  String       @unique @db.Char(36)
  eventoId  Int          @db.Int()

  comprador Comprador    @relation(fields: [compradorId], references: [id])
  ticket  Ticket         @relation(fields: [ticketId], references: [id])
  evento  Evento         @relation(fields: [eventoId], references: [id])

  createdAt DateTime     @default(now()) @map("created_at")
  updatedAt DateTime     @default(now()) @updatedAt @map("updated_at")

  @@map("compras")
}

model TipoTicket {
  id         Int    @id @default(autoincrement()) @db.Int()
  descricao  String @db.VarChar(50)

  ticket              Ticket[]
  tiposTicketsEventos TiposTicketsEventos[]

  @@map("tipoTickets")
}

model TiposTicketsEventos {
  eventoId       Int @db.Int()
  tipoTicketId   Int @db.Int()
  quantidade     Int @db.Int()
  preco          Decimal  @db.Decimal(9, 2)

  evento     Evento @relation(fields: [eventoId], references: [id])
  tipoTicket TipoTicket @relation(fields: [tipoTicketId], references: [id])

  @@id([eventoId, tipoTicketId])
  @@map("tipoTicketsEventos")
}

model CategoriaEvento {
  id        Int    @id @default(autoincrement()) @db.Int()
  descricao String @db.VarChar(50)

  evento Evento[]

  @@map("categoriaEvento")
}
